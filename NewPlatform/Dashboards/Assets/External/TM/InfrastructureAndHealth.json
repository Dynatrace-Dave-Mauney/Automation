{"version":11,"variables":[{"key":"ManagementZone","type":"code","input":"import { settingsObjectsClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nexport default async function fetchMetricResults() {\n  try{\n    const data = await settingsObjectsClient.getSettingsObjects({\n      schemaIds: \"builtin:management-zones\",\n      pageSize: 500\n    });\n    console.log(data);\n    let arr = [\"ALL\"];\n    (data.items).map(result => {\n      arr.push(result.value.name);\n    });    \n    return arr.sort();\n  }\n  catch(e){\n    console.log(e);\n  }\n}","multiple":false},{"key":"OS","type":"csv","input":"ALL, WINDOWS, LINUX","multiple":false}],"tiles":{"0":{"type":"code","title":"Availability ðŸ”´ <99%   ðŸŸ¨ <99.9%","input":"import { metricsClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nexport default async function main() {\n  const metric = \"builtin:host.availability.state:filter(eq(\\\"availability.state\\\",\\\"up\\\")):value:splitBy(\\\"dt.entity.host\\\"):names/builtin:host.availability.state:splitBy(\\\"dt.entity.host\\\"):names\";\n\n  let eS = \"\";\n  if($ManagementZone != \"ALL\") eS = \",mzName(\\\"\" + $ManagementZone.toString() + \"\\\")\";\n  let eS2 = \"type(HOST)\";\n  if($OS == \"WINDOWS\") eS2 += \",tag(\\\"OS:Windows\\\")\";\n  else if ($OS == \"LINUX\") eS2 += \",tag(\\\"OS:Linux\\\")\";\n  \n  const data = await metricsClient.query({\n    acceptType: \"application/json; charset=utf-8\",\n    metricSelector: metric,\n    resolution: \"inf\",\n    entitySelector: eS2 + eS,\n    from: \"now-3m\",\n    to: \"now\"\n  });\n\n  let processedResults = [];\n  (data.result[0].data).map(result => { \n    if(result.values[0] != 1){\n      processedResults.push({\n        \"Host\": result.dimensionMap[\"dt.entity.host.name\"],\n        \"Avail\": result.values[0] * 100\n      });\n    }\n  });\n  processedResults.sort((a, b) => a.Avail - b.Avail);\n\n  const arr = []\n  for (let i=0;i<processedResults.length;i++) {\n    arr.push({...processedResults[i]})\n  }\n  if (arr.length > 0) return arr;\n  else return [{\n      \"Host\": \"No hosts below Threshold\",\n      \"Value\": \"âœ…\"\n  }];\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Avail","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"â‰¥","label":""},{"id":1,"color":"#FFFF00","comparator":"<","label":"","value":100},{"id":2,"color":"#FF0000","comparator":"â‰¤","label":"","value":99}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"Host\"]":303.4296875,"[\"Availability\"]":118.98046875,"[\"Value\"]":84.99609375,"[\"Avail\"]":80}},"unitsOverrides":[{"identifier":"Avail","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1700156988919}]}},"1":{"type":"code","title":"Memory Usage ðŸ”´> 90%  ðŸŸ¨> 80%","input":"import { metricsClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nconst metric = \"builtin:host.mem.usage:filter(series(avg,ge(80)),and(or(in(\\\"dt.entity.host\\\",entitySelector(\\\"type(host)\\\"))))):fold(avg):names\";\nconst entityType = \"HOST\";\n\nexport default async function main() {\n    let eS = \"\";\n    if($ManagementZone != \"ALL\") eS = \",mzName(\\\"\" + $ManagementZone.toString() + \"\\\")\";\n    let eS2 = \"type(HOST)\";\n    if($OS == \"WINDOWS\") eS2 += \",tag(\\\"OS:Windows\\\")\";\n    else if ($OS == \"LINUX\") eS2 += \",tag(\\\"OS:Linux\\\")\";\n    \n    const data = await metricsClient.query({\n      acceptType: \"application/json; charset=utf-8\",\n      metricSelector: metric,\n      //resolution: \"inf\",\n      entitySelector: eS2 + eS,\n      from: Date.parse($dt_timeframe_from).toString(),\n      to: Date.parse($dt_timeframe_to).toString()\n    });\n    \n    const processedResults: MetricResult[] = (data.result[0].data).map(result => {\n      return{\n        \"Host\": result.dimensionMap[\"dt.entity.host.name\"],\n        \"Mem\": result.values[0]\n      };\n    });\n    processedResults.sort((a, b) => b.Mem - a.Mem);\n\n    const arr = []\n    for (let i=0;i<processedResults.length;i++) {\n      arr.push({...processedResults[i]})\n    }\n    if (arr.length > 0) return arr;\n    else return [{\n        \"Host\": \"No hosts below Threshold\",\n        \"Value\": \"âœ…\"\n    }];\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Mem","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"â‰¥","label":""},{"id":1,"color":"#FFFF00","comparator":"â‰¥","label":"","value":80},{"id":2,"color":"#FF0000","comparator":"â‰¥","label":"","value":90}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"Sev\"]":70.93359375,"[\"Host\"]":301.83203125,"[\"Memory\"]":100.11328125,"[\"ID\"]":185,"[\"Hdsfost\"]":174,"[\"Mem\"]":80}},"unitsOverrides":[{"identifier":"Mem","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1700154150365}]}},"2":{"type":"code","title":"CPU ðŸ”´ >90%   ðŸŸ¨ >80%","input":"import { metricsClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nconst metric = \"builtin:host.cpu.usage:filter(series(avg,ge(80)),and(or(in(\\\"dt.entity.host\\\",entitySelector(\\\"type(host)\\\"))))):fold(avg):names\";\n\nexport default async function main() {\n  let eS = \"\";\n  if($ManagementZone != \"ALL\") eS = \",mzName(\\\"\" + $ManagementZone.toString() + \"\\\")\";\n  let eS2 = \"type(HOST)\";\n  if($OS == \"WINDOWS\") eS2 += \",tag(\\\"OS:Windows\\\")\";\n  else if ($OS == \"LINUX\") eS2 += \",tag(\\\"OS:Linux\\\")\";\n  \n  const data = await metricsClient.query({\n    acceptType: \"application/json; charset=utf-8\",\n    metricSelector: metric,\n    //resolution: \"inf\",\n    entitySelector: eS2 + eS,\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString()\n  });\n  \n  const processedResults: MetricResult[] = (data.result[0].data).map(result => { \n    return{\n      \"Host\": result.dimensionMap[\"dt.entity.host.name\"],\n      \"CPU\": result.values[0]\n    };\n  });\n  processedResults.sort((a, b) => b.CPU - a.CPU);\n\n  const arr = []\n  for (let i=0;i<processedResults.length;i++) {\n    arr.push({...processedResults[i]})\n  }\n  if (arr.length > 0) return arr;\n  else return [{\n      \"Host\": \"No hosts above Threshold\",\n      \"Value\": \"âœ…\"\n  }];\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"CPU","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"â‰¥","label":""},{"id":1,"color":"#FFFF00","comparator":"â‰¥","label":"","value":80},{"id":2,"color":"#FF0000","comparator":"â‰¥","label":"","value":90}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"Sev\"]":69.93359375,"[\"Host\"]":301.80078125,"[\"CPU\"]":74.2734375}},"unitsOverrides":[{"identifier":"CPU","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1700154052920}]}},"3":{"type":"code","title":"Problems by Location","input":"import { problemsClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nlet probs = [];\nlet MZS = {noManagementZone: 0};\nlet okMZ = \"APP-PRJU\";\n\nasync function getProblems() {\n  let probS = \"\";\n  if($OS == \"WINDOWS\") probS += \"entityTags(\\\"OS:Windows\\\"),\";\n  else if ($OS == \"LINUX\") probS += \"entityTags(\\\"OS:Linux\\\"),\";\n  if($ManagementZone != \"ALL\") probS += \"managementZones(\" + $ManagementZone.toString() + \"),\";\n  probS += \"status(\\\"open\\\")\"; \n  const config = {\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),\n    problemSelector: probS,  \n    pageSize: 500\n  };  \n  try{\n    const pQuery = await problemsClient.getProblems(config);\n    probs = pQuery.problems;\n    if(pQuery.hasOwnProperty(\"nextPageKey\") && pQuery.nextPageKey != null) return await next(pQuery.nextPageKey);\n    else return 1;\n  }\n  catch(e){\n    console.log(e);\n  }\n}\n\nexport default async function main() {\n    try{\n      const v = await getProblems();\n    }\n    catch(e){\n      console.log(e);\n    }\n    probs.map(result => {      \n      if(result.managementZones.length > 0) {\n        result.managementZones.map(mzs => {\n          if(MZS.hasOwnProperty(mzs.name)) MZS[mzs.name] = Number(MZS[mzs.name])+1;\n          else MZS[mzs.name] = 1;\n        });\n      }\n      else MZS.noManagementZone++;\n    });\n    const ref = Object.keys(MZS);\n    const processedResults: MetricResult[] = ref.map(result => { \n      return{\n        \"Management Zone\": result,\n        \"Count\": Number(MZS[result])\n      };\n    });    \n    processedResults.sort((a, b) => b[\"Count\"] - a[\"Count\"]);\n\n    const arr = []\n    for (let i=0;i<processedResults.length;i++) {\n      arr.push({...processedResults[i]})\n    }\n    return arr;\n}\n\nasync function next(npk){\n  try{\n    const pfq = await problemsClient.getProblems({nextPageKey: npk});\n    probs = probs.concat(pfq.problems);    \n    if(pfq.hasOwnProperty(\"nextPageKey\") && pfq.nextPageKey != null) return await next(pfq.nextPageKey);\n    else return 1;\n  }\n  catch(e){\n    console.log(e);\n  }\n}","visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"Management Zone\"]":188.30113220214844,"[\"Problems\"]":108.57954406738281,"[\"Count\"]":86}},"unitsOverrides":[{"identifier":"Count","unitCategory":"unspecified","baseUnit":"count","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1700157335740}]}},"5":{"type":"code","title":"Host Health","input":"import { monitoredEntitiesClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nexport default async function fetchMetricResults() {\n  let eS = \"\";\n  if($ManagementZone != \"ALL\") eS += \",mzName(\\\"\" + $ManagementZone.toString() + \"\\\")\";\n  \n  const healthy = await monitoredEntitiesClient.getEntities({\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),\n    entitySelector: \"type(HOST),healthState(\\\"HEALTHY\\\")\" + eS,\n    pageSize: 1\n  });\n  const bad = await monitoredEntitiesClient.getEntities({\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),\n    entitySelector: \"type(HOST),healthState(\\\"UNHEALTHY\\\")\",\n    pageSize: 1\n  });\n  return ((healthy.totalCount *100) / (healthy.totalCount + bad.totalCount)).toFixed(2) + \" % : ðŸŸ¢ \" + healthy.totalCount +  \" | ðŸ”´ \"  + bad.totalCount;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":false,"alignment":"center"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"columnWidths":{}}}},"6":{"type":"code","title":"Disk Space ðŸ”´> 90%   ðŸŸ¨ >80%","input":"import { metricsClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nconst metric = \"builtin:host.disk.usedPct:filter(series(avg,ge(80)),and(or(in(\\\"dt.entity.host\\\",entitySelector(\\\"type(host)\\\"))))):splitBy(\\\"dt.entity.host\\\",\\\"dt.entity.disk\\\"):names\";\nconst okDisk = [\"/boot\", \"/root\", \"A:\\\\\", \"B:\\\\\", \"C:\\\\\", \"D:\\\\\", \"E:\\\\\", \"F:\\\\\", \"G:\\\\\", \"H:\\\\\", \"I:\\\\\", \"J:\\\\\", \"K:\\\\\", \"L:\\\\\", \"M:\\\\\", \"N:\\\\\", \"O:\\\\\", \"P:\\\\\", \"Q:\\\\\", \"R:\\\\\", \"S:\\\\\", \"T:\\\\\", \"U:\\\\\", \"V:\\\\\", \"W:\\\\\", \"X:\\\\\", \"Y:\\\\\", \"Z:\\\\\"];\n\nexport default async function main() {\n  let eS = \"\";\n  if($ManagementZone != \"ALL\") eS = \",mzName(\\\"\" + $ManagementZone.toString() + \"\\\")\";\n  let eS2 = \"type(HOST)\";\n  if($OS == \"WINDOWS\") eS2 += \",tag(\\\"OS:Windows\\\")\";\n  else if ($OS == \"LINUX\") eS2 += \",tag(\\\"OS:Linux\\\")\";\n  \n  const data = await metricsClient.query({\n    acceptType: \"application/json; charset=utf-8\",\n    metricSelector: metric,\n    resolution: \"inf\",\n    entitySelector: eS2 + eS,\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString()\n  });\n\n  let processedResults = [];\n  (data.result[0].data).map(result => { \n    if(okDisk.includes(result.dimensionMap[\"dt.entity.disk.name\"])){\n      processedResults.push({\n        \"Host\": result.dimensionMap[\"dt.entity.host.name\"],\n        \"Disk\": result.dimensionMap[\"dt.entity.disk.name\"],        \n        \"Usage\": result.values[0]\n      });\n    }\n  });\n  processedResults.sort((a, b) => b.Usage - a.Usage);\n\n  const arr = []\n  for (let i=0;i<processedResults.length;i++) {\n    arr.push({...processedResults[i]})\n  }\n  if (arr.length > 0) return arr;\n  else return [{\n      \"Host\": \"No hosts below Threshold\",\n      \"Value\": \"âœ…\"\n  }];\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Usage","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"â‰¥","label":""},{"id":1,"color":"#FFFF00","comparator":"â‰¥","label":"","value":80},{"id":2,"color":"#FF0000","comparator":"â‰¥","label":"","value":90}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"Sev\"]":70.93359375,"[\"Host\"]":273.890625,"[\"Disk\"]":107.90625,"[\"SpaceUsed\"]":117.9140625,"[\"Usage\"]":87.26953125}},"unitsOverrides":[{"identifier":"Usage","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1700159931497}]}},"8":{"type":"markdown","title":"","content":"![](company logo link goes here)"},"10":{"type":"code","title":"Host Health (Windows)","input":"import { monitoredEntitiesClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nexport default async function fetchMetricResults() {\n  let eS = \"\";\n  if($ManagementZone != \"ALL\") eS += \",mzName(\\\"\" + $ManagementZone.toString() + \"\\\")\";\n  \n  const healthy = await monitoredEntitiesClient.getEntities({\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),\n    entitySelector: \"type(HOST),healthState(\\\"HEALTHY\\\"),tag(\\\"OS:Windows\\\")\" + eS,\n    pageSize: 1\n  });\n  const bad = await monitoredEntitiesClient.getEntities({\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),\n    entitySelector: \"type(HOST),healthState(\\\"UNHEALTHY\\\"),tag(\\\"OS:Windows\\\")\" + eS,\n    pageSize: 1\n  });\n  return ((healthy.totalCount *100) / (healthy.totalCount + bad.totalCount)).toFixed(2) + \" % : ðŸŸ¢ \" + healthy.totalCount +  \" | ðŸ”´ \"  + bad.totalCount;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":false,"alignment":"center"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"columnWidths":{}}}},"11":{"type":"code","title":"Host Health (Linux)","input":"import { monitoredEntitiesClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nexport default async function fetchMetricResults() {\n  let eS = \"\";\n  if($ManagementZone != \"ALL\") eS += \",mzName(\\\"\" + $ManagementZone.toString() + \"\\\")\";\n  \n  const healthy = await monitoredEntitiesClient.getEntities({\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),\n    entitySelector: \"type(HOST),healthState(\\\"HEALTHY\\\"),tag(\\\"OS:Linux\\\")\" + eS,\n    pageSize: 1\n  });\n  const bad = await monitoredEntitiesClient.getEntities({\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),\n    entitySelector: \"type(HOST),healthState(\\\"UNHEALTHY\\\"),tag(\\\"OS:Linux\\\")\" + eS,\n    pageSize: 1\n  });\n  return ((healthy.totalCount *100) / (healthy.totalCount + bad.totalCount)).toFixed(2) + \" % : ðŸŸ¢ \" + healthy.totalCount +  \" | ðŸ”´ \"  + bad.totalCount;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":false,"alignment":"center"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"columnWidths":{}}}},"12":{"type":"code","title":"Overall Host Availability","input":"import { metricsClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nconst metric = \"builtin:host.availability.state:filter(eq(\\\"availability.state\\\",\\\"up\\\")):value:splitBy(\\\"dt.entity.host\\\"):names/builtin:host.availability.state:splitBy(\\\"dt.entity.host\\\"):names\";\n\nexport default async function main() {\n  let availability = 0;\n\n  let eS = \"\";\n  if($ManagementZone != \"ALL\") eS = \",mzName(\\\"\" + $ManagementZone.toString() + \"\\\")\";\n  let eS2 = \"type(HOST)\";\n  if($OS == \"WINDOWS\") eS2 += \",tag(\\\"OS:Windows\\\")\";\n  else if ($OS == \"LINUX\") eS2 += \",tag(\\\"OS:Linux\\\")\";\n  \n  const data = await metricsClient.query({\n    acceptType: \"application/json; charset=utf-8\",\n    metricSelector: metric,\n    resolution: \"inf\",\n    entitySelector: eS2 + eS,\n    from: \"now-3m\",\n    to: \"now\"\n  });\n  \n  (data.result[0].data).map(result => {\n    availability += (result.values[0] * 100);\n  });\n\n  if ((data.result[0].data).length > 0) {\n    let ret = (availability / ((data.result[0].data).length)).toFixed(2)\n    if(ret > 99.9) return \"ðŸŸ¢ \" + ret + \" %\";\n    else if(ret > 99) return \"ðŸŸ¨ \" + ret + \" %\";\n    else return \"ðŸ”¥ \" + ret + \" %\";\n  }\n  else return \"No data\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"Availability","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"â‰¥","label":""},{"id":1,"color":"#FFFF00","comparator":"<","label":"","value":100},{"id":2,"color":"#FF0000","comparator":"â‰¤","label":"","value":98}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false}},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"Host\"]":305.4296875,"[\"Availability\"]":118.98046875,"[\"Value\"]":84.99609375}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":"percent","decimals":2,"suffix":"","delimiter":false,"added":1700156988919}]}},"13":{"type":"markdown","title":"","content":"Developed by Trevor Massengill. Reach out to trevor.massengill@dynatrace.com for feedback."},"14":{"type":"markdown","title":"","content":"## Links\n\n[Link 1]()\n\n[Link 3]()\n\n[Link 4]()\n\n[Link 5]()\n\n[Link 6]()"},"15":{"type":"markdown","title":"","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"16":{"type":"code","title":"Open Problems - Total | Crit | Warn","input":"import { problemsClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nexport default async function fetchMetricResults() {\n  let probS = \"\";\n  if($OS == \"WINDOWS\") probS += \"entityTags(\\\"OS:Windows\\\"),\";\n  else if ($OS == \"LINUX\") probS += \"entityTags(\\\"OS:Linux\\\"),\";\n  if($ManagementZone != \"ALL\") probS += \"managementZones(\" + $ManagementZone.toString() + \"),\";\n  probS += \"status(\\\"open\\\")\";\n  \n  const total = await problemsClient.getProblems({\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),    \n    problemSelector: probS,\n    pageSize: 1\n  });\n  \n  const critical = await problemsClient.getProblems({\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),    \n    problemSelector: \"text(\\\"CRITICAL\\\"),\" + probS,\n    pageSize: 1\n  });\n  \n  const warning = await problemsClient.getProblems({\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),    \n    problemSelector: \"text(\\\"WARNING\\\"),\" + probS,\n    pageSize: 1\n  });\n  \n  return total.totalCount + \" | ðŸ”´ \" + critical.totalCount + \" | ðŸŸ¨ \" + warning.totalCount\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"Availability","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"â‰¥","label":""},{"id":1,"color":"#FFFF00","comparator":"<","label":"","value":100},{"id":2,"color":"#FF0000","comparator":"â‰¤","label":"","value":98}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false}},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"Host\"]":305.4296875,"[\"Availability\"]":118.98046875,"[\"Value\"]":84.99609375}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":"percent","decimals":2,"suffix":"","delimiter":false,"added":1700156988919}]}},"18":{"type":"code","title":"Open Problems","input":"import { problemsClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nlet probs = [];\nconst categoryOrder = { 'ðŸ”´': 1, 'ðŸŸ¨': 2, ' ': 3 };\n\nasync function getProblems() {\n  let probS = \"\";\n  if($OS == \"WINDOWS\") probS += \"entityTags(\\\"OS:Windows\\\"),\";\n  else if ($OS == \"LINUX\") probS += \"entityTags(\\\"OS:Linux\\\"),\";\n  if($ManagementZone != \"ALL\") probS += \"managementZones(\" + $ManagementZone.toString() + \"),\";\n  probS += \"status(\\\"open\\\")\"; \n  const pQuery = await problemsClient.getProblems({\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString(),    \n    problemSelector: probS,\n    pageSize: 500\n  });\n  probs = pQuery.problems;\n  if(pQuery.hasOwnProperty(\"nextPageKey\") && pQuery.nextPageKey != null) return await next(pQuery.nextPageKey);\n  else return 1;\n}\n\nexport default async function main() {\n  const v = await getProblems();\n  const d = (new Date()).getTime();\n  const processedResults: MetricResult[] = probs.map(result => {\n    let ARC = \"null\";\n    if(result.hasOwnProperty(\"impactedEntities\") && result.impactedEntities.length > 0) ARC = result.impactedEntities[0].name;\n    if(result.hasOwnProperty(\"rootCauseEntity\") && String(result.rootCauseEntity) != \"undefined\") ARC = result.rootCauseEntity.name;\n    let lv = \" \";\n    if((result.title).includes(\"Critical\")) lv = \"ðŸ”´\";\n    else if((result.title).includes(\"Warning\")) lv = \"ðŸŸ¨\";\n    return {\n      \"Lv\": lv,\n      \"Problem ID\": result.displayId,\n      \"Title\": result.title,\n      \"Assigned Root Cause\": ARC, \n      \"StartTime\": new Date(result.startTime),\n      \"Length\": (d - result.startTime) / (60000)\n    };\n  });\n  processedResults.sort((a, b) => {\n    let categoryComparison = categoryOrder[a.Lv] - categoryOrder[b.Lv];\n\n    return categoryComparison !== 0 ? categoryComparison : b[\"Length\"] - a[\"Length\"];\n  });\n\n  const arr = []\n  for (let i=0;i<processedResults.length;i++) {\n    arr.push({...processedResults[i]})\n  }\n  return arr;\n}\n\nasync function next(npk){\n  const pfq = await problemsClient.getProblems({nextPageKey: npk});\n  probs = probs.concat(pfq.problems);    \n  if(pfq.hasOwnProperty(\"nextPageKey\") && pfq.nextPageKey != null) return await next(pfq.nextPageKey);\n  else return 1;\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Length","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"â‰¥","label":""},{"id":1,"color":"#FFFF00","comparator":"â‰¥","label":"","value":240},{"id":2,"color":"#FF0000","comparator":"â‰¥","label":"","value":1440}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"Host\"]":305.4296875,"[\"Availability\"]":118.98046875,"[\"Value\"]":84.99609375,"[\"Title\"]":397,"[\"Assigned Root Cause\"]":429,"[\"StartTime\"]":178,"[\"Length (mins)\"]":137,"[\"Problem ID\"]":112,"[\"Length\"]":93,"[\"Lv\"]":69}},"unitsOverrides":[{"identifier":"Length","unitCategory":"time","baseUnit":"minute","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1700156988919}]}},"20":{"type":"code","title":"Network Traffic  ðŸ”´> 50GB  ðŸŸ¨> 3GB","input":"import { metricsClient } from \"@dynatrace-sdk/client-classic-environment-v2\";\n\nconst metric = \"builtin:host.net.nic.traffic:filter(series(avg,ge(3000000000))):names\";\n\nexport default async function main() {  \n  let eS = \"\";\n  if($ManagementZone != \"ALL\") eS = \",mzName(\\\"\" + $ManagementZone.toString() + \"\\\")\";\n  let eS2 = \"type(HOST)\";\n  if($OS == \"WINDOWS\") eS2 += \",tag(\\\"OS:Windows\\\")\";\n  else if ($OS == \"LINUX\") eS2 += \",tag(\\\"OS:Linux\\\")\";\n  \n  const data = await metricsClient.query({\n    acceptType: \"application/json; charset=utf-8\",\n    metricSelector: metric,\n    resolution: \"inf\",\n    entitySelector: eS2 + eS,\n    from: Date.parse($dt_timeframe_from).toString(),\n    to: Date.parse($dt_timeframe_to).toString()\n  });\n    \n  const processedResults: MetricResult[] = (data.result[0].data).map(result => { \n    return{\n      \"Host\": result.dimensionMap[\"dt.entity.host.name\"],\n      \"Net.Int.\": result.dimensionMap[\"dt.entity.network_interface.name\"],\n      \"Traffic\": result.values[0]\n    };\n  });\n  processedResults.sort((a, b) => b.Traffic - a.Traffic);\n\n  const arr = [];\n  for (let i=0;i<processedResults.length;i++) {\n    arr.push({...processedResults[i]})\n  }\n  if (arr.length > 0) return arr;\n  else return [{\n      \"Host\": \"No hosts above Threshold\",\n      \"Net.Int.\": \"No hosts above Threshold\",\n      \"Traffic\": \"âœ…\"\n  }];\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Traffic","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"â‰¥","label":""},{"id":1,"color":"#FFFF00","comparator":"â‰¥","label":"","value":3000000000},{"id":2,"color":"#FF0000","comparator":"â‰¥","label":"","value":50000000000}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"Sev\"]":70.93359375,"[\"Host\"]":242.83203125,"[\"Memory\"]":100.11328125,"[\"Net.Int.\"]":127,"[\"Traffic\"]":131}},"unitsOverrides":[{"identifier":"Traffic","unitCategory":"data","baseUnit":"byte","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1700154150365}]}}},"layouts":{"0":{"x":3,"y":9,"w":4,"h":5},"1":{"x":7,"y":14,"w":4,"h":5},"2":{"x":7,"y":9,"w":4,"h":5},"3":{"x":0,"y":5,"w":3,"h":9},"5":{"x":6,"y":1,"w":3,"h":2},"6":{"x":11,"y":14,"w":5,"h":5},"8":{"x":0,"y":1,"w":3,"h":2},"10":{"x":9,"y":1,"w":3,"h":2},"11":{"x":12,"y":1,"w":3,"h":2},"12":{"x":3,"y":1,"w":3,"h":2},"13":{"x":0,"y":0,"w":22,"h":1},"14":{"x":0,"y":14,"w":3,"h":5},"15":{"x":3,"y":8,"w":13,"h":1},"16":{"x":0,"y":3,"w":3,"h":2},"18":{"x":3,"y":3,"w":13,"h":5},"20":{"x":11,"y":9,"w":5,"h":5}}}