<html>
	<head>
		<title>Dynatrace JavaScript API</title>
        <link href="../global.css" rel="stylesheet" type="text/css">
        <script type="text/javascript" src="../global.js"></script>
        <script type="text/javascript">
            function initFrameWork() {
                dtrum.incrementOnLoadEndMarkers();
                dtrum.signalOnLoadStart();
                var xhr = new XMLHttpRequest();
                xhr.open('GET', '../ajax.txt', false);
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4) {
                        document.getElementById('resultDiv').innerHTML = 'Framework load finished';
                        dtrum.signalOnLoadEnd();
                    }
                };
                xhr.send(null);
            }
        </script>
	</head>

    <body onload="initFrameWork()">
        <div class="explanation">
            <h2>Custom onload with XHR Request</h2>
            <div class="field">
                <div class="fieldHeader"> Agentconfig</div>
                Needed agent module configuration: <div class="agentConf">Support for XmlHttpRequest<div class="agentConfCheck"></div></div>
            </div>
            <p>This example demonstrates how to manually begin and end the onLoad signal.</p>
            <p>For the agent to wait for an additional onLoadEnd, first <a href='../../doc/interfaces/dtrum_types.dtrumapi.html#incrementonloadendmarkers' class='api-reference' target='_blank'>incrementOnLoadEndMarkers</a> has to be called.</p>
            <p>To start the onLoad <a href='../../doc/interfaces/dtrum_types.dtrumapi.html#signalonloadstart' class='api-reference' target='_blank'>signalOnLoadStart</a> can be called (only if the load start is different than the page load start).</p>
            <p>After the load <a href='../../doc/interfaces/dtrum_types.dtrumapi.html#signalonloadend' class='api-reference' target='_blank'>signalOnLoadEnd</a> should be called to end the onLoad signal.</p>
        </div>
        <div class="field">
            <div class="fieldHeader"> Code snippet</div>
            <code-block>dtrum.incrementOnLoadEndMarkers();
dtrum.signalOnLoadStart();
var xhr = new XMLHttpRequest();
xhr.open('GET', '../ajax.txt', false);
xhr.onreadystatechange = function() {
    if (xhr.readyState === 4) {
        document.getElementById('resultDiv').innerHTML = 'Framework load finished';
        dtrum.signalOnLoadEnd();
    }
};</code-block>
        </div>
        <div class="field example">
            <div class="fieldHeader"> Example</div>
            <div id="resultDiv">Result will be displayed here when framework is loaded completely!</div>
        </div>
        <a class="backButton" href="../index.html"> &#x2B05; Back</a>
    </body>
</html>
